# Sales Assistant TODO / Backlog

> 更新日期：2025-10-06

| 分类 | 事项 | 优先级 | 说明 |
| --- | --- | --- | --- |
| 稳定性 | **LLM 响应治理** | 高 | DashScope/Qwen 偶发返回非法 JSON，需要：① 收集原始响应样本；② 调整 prompt（拆分输出、限制字段长度）；③ 评估是否引入服务端后处理，自动修正常见格式问题。 |
| 稳定性 | **任务重试与告警** | 高 | 失败任务仅记录错误并停止，可考虑在 `TaskService` 加入重试次数、失败邮件/钉钉提醒。 |
| 体验 | **进度可视化** | 中 | 目前轮询仅显示“排队/计算中”，可接入任务里程碑或估算剩余时间。 |
| 体验 | **长任务通知** | 中 | 规划中的“消息通知”未实现，可结合邮件/企业微信机器人在任务完成后推送结果链接。 |
| 体验 | **下载历史结果** | 低 | 工时/成本结果存于 JSON，可提供导出历史列表，便于离线归档。 |
| 架构 | **真正的异步任务队列** | 中 | FastAPI BackgroundTasks 适合短任务。建议评估 Celery + Redis/RabbitMQ 或 Dramatiq，支持多 worker 与任务追踪。 |
| 架构 | **数据库迁移工具** | 中 | 引入 Alembic 管理 schema 版本，方便未来扩展字段。 |
| 架构 | **LLM 多提供商抽象** | 中 | 目前以 DashScope 为主，可封装 provider Adapter，支持同时接入 OpenAI、Azure、Ollama。 |
| 安全 | **权限分组 / 组织隔离** | 中 | 现仅支持单租户。需要扩展用户-组织表、数据范围控制及审计日志。 |
| 安全 | **手机号短信验证** | 高 | 注册与找回密码需短信验证码，目前仅返回令牌用于调试，需要接入短信平台。 |
| 文档 | **API Postman 集合** | 低 | 整理 API 样例，便于测试。 |
| 文档 | **部署脚本自动化** | 低 | 目前 README 仅提供手动步骤，可编写 Ansible/ Terraform 或 Shell 一键部署脚本。 |
| 小程序 | **真机上传/下载优化** | 中 | 需要验证大文件上传、进度提示、弱网重试等细节。 |
| 小程序 | **微信登录授权** | 中 | 实现手机号快速登录，与后端账号体系打通。 |
| 小程序 | **小程序端下载报表** | 低 | 需封装导出接口并适配微信文件系统。 |

## 已完成检查项

- [x] 统一 README 与架构文档，补充整体技术说明。
- [x] 将工时/成本任务改为统一的后台任务模式，前端提示可离开页面。
- [x] 为 DashScope 调用增加 JSON 解析重试与原始响应日志。

> 若有新需求或问题，请在此表补充，并同步到团队任务管理工具。
